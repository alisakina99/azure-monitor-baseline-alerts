{
  "$schema": "https://schema.management.azure.com/schemas/2021-09-09/uiFormDefinition.schema.json#",
  "view": {
      "kind": "Form",
      "properties": {
          "title": "Azure landing zone accelerator",
          "steps": [
              {
                  "name": "monitor",
                  "label": "Baseline alerts and monitoring",
                  "subLabel": {
                      "preValidation": "",
                      "postValidation": ""
                  },
                  "bladeTitle": "ALZ - Baseline Alerts",
                  "elements": [
                      {
                          "name": "baselinealertsintro",
                          "type": "Microsoft.Common.InfoBox",
                          "visible": true,
                          "options": {
                              "text": "Azure Landing Zones will create ARM automation to deploy baseline alerts automatically as resources are deployed. Note that selecting Yes to the Option 'Deploy one or more Azure Monitor Baseline Alerts', will automatically import all policies and initiatives and will assign the Deploy Azure Monitor Baseline Alerts for Service Health policy initiative at the intermediate root.",
                              "uri": "https://aka.ms/amba/alz/docs",
                              "style": "Info"
                          }
                      },
                      {
                          "name": "enableMonitorBaselines",
                          "type": "Microsoft.Common.OptionsGroup",
                          "label": "Deploy one or more Azure Monitor Baseline Alerts",
                          "defaultValue": "Yes (recommended)",
                          "toolTip": "If 'Yes' is selected Azure Monitor Baseline Alerts can be enabled for the selected resources. Note that choosing Yes will import all Monitor baseline alerts into your environment, and assign the Deploy Azure Monitor Service Health policy initiative to your designated intermediate root. For more information on what is included in the Service Health initiative please refer to https://aka.ms/amba/alz/wiki under Azure Policy Initiatives and Alert Details",
                          "constraints": {
                              "allowedValues": [
                                  {
                                      "label": "Yes (recommended)",
                                      "value": "Yes"
                                  },
                                  {
                                      "label": "No",
                                      "value": "No"
                                  }
                              ]
                          },
                          "visible": true
                      },
                      {
                          "name": "monitorAlertsResourceGroup",
                          "type": "Microsoft.Common.TextBox",
                          "label": "Resource group for baseline alerts",
                          "toolTip": "Resource group for activity log alerts and action groups. Will be created in all subscriptions in scope for the policy",
                          "visible": "[equals(steps('monitor').enableMonitorBaselines,'Yes')]",
                          "defaultValue": "rg-amba-monitoring-001",
                          "constraints": {
                              "required": "[equals(steps('monitor').enableMonitorBaselines,'Yes')]",
                              "regex": "^[a-zA-Z0-9][a-zA-Z0-9-_.()]{0,89}[a-zA-Z0-9]$",
                              "validationMessage": "Please provide a valid resource group name"
                          }
                      },
                      {
                          "name": "emailContactActionGroup",
                          "type": "Microsoft.Common.TextBox",
                          "label": "Email contact for action group notifications",
                          "toolTip": "Email address to get email notifications from alerts",
                          "visible": "[equals(steps('monitor').enableMonitorBaselines,'Yes')]",
                          "defaultValue": "",
                          "constraints": {
                              "required": "[equals(steps('monitor').enableMonitorBaselines,'Yes')]",
                              "regex": "^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$",
                              "validationMessage": "Please provide a valid email address"
                          }
                      },
                      {
                          "name": "enableMonitorConnectivity",
                          "type": "Microsoft.Common.OptionsGroup",
                          "label": "Enable Azure Monitor Baseline Alerts for Connectivity. ",
                          "defaultValue": "Yes (recommended)",
                          "toolTip": "If 'Yes' is selected the Deploy Azure Monitor Baseline Alerts for Connectivity policy initiative is assigned to the Connectivity management group. This will ensure that relevant new resources created within that scope are configured with appropriate baseline alerts. For more details on what is included in the initiative please refer to https://aka.ms/amba/alz/wiki under Azure Policy Initiatives and Alert Details.",
                          "constraints": {
                              "allowedValues": [
                                  {
                                      "label": "Yes (recommended)",
                                      "value": "Yes"
                                  },
                                  {
                                      "label": "No",
                                      "value": "No"
                                  }
                              ]
                          },
                          "visible": "[equals(steps('monitor').enableMonitorBaselines,'Yes')]"
                      },
                      {
                          "name": "enableMonitorIdentity",
                          "type": "Microsoft.Common.OptionsGroup",
                          "label": "Enable Azure Monitor Baseline Alerts for Identity",
                          "defaultValue": "Yes (recommended)",
                          "toolTip": "If 'Yes' is selected the Deploy Azure Monitor Baseline Alerts for Identity policy initiative is assigned to the Identity management group. This will ensure that relevant new resources created within that scope are configured with appropriate baseline alerts. For more details on what is included in the initiative please refer to https://aka.ms/amba/alz/wiki under Azure Policy Initiatives and Alert Details.",
                          "constraints": {
                              "allowedValues": [
                                  {
                                      "label": "Yes (recommended)",
                                      "value": "Yes"
                                  },
                                  {
                                      "label": "No",
                                      "value": "No"
                                  }
                              ]
                          },
                          "visible": "[equals(steps('monitor').enableMonitorBaselines,'Yes')]"
                      },
                      {
                          "name": "enableMonitorManagement",
                          "type": "Microsoft.Common.OptionsGroup",
                          "label": "Enable Azure Monitor Baseline Alerts for Management",
                          "defaultValue": "Yes (recommended)",
                          "toolTip": "If 'Yes' is selected the Deploy Azure Monitor Baseline Alerts for Management policy initiative is assigned to the Management management group. This will ensure that relevant new resources created within that scope are configured with appropriate baseline alerts. For more details on what is included in the initiative please refer to https://aka.ms/amba/alz/wiki under Azure Policy Initiatives and Alert Details.",
                          "constraints": {
                              "allowedValues": [
                                  {
                                      "label": "Yes (recommended)",
                                      "value": "Yes"
                                  },
                                  {
                                      "label": "No",
                                      "value": "No"
                                  }
                              ]
                          },
                          "visible": "[equals(steps('monitor').enableMonitorBaselines,'Yes')]"
                      },
                      {
                          "name": "enableMonitorLandingZones",
                          "type": "Microsoft.Common.OptionsGroup",
                          "label": "Enable Azure Monitor Baseline Alerts for Landing Zones",
                          "defaultValue": "Yes (recommended)",
                          "toolTip": "If 'Yes' is selected the Deploy Azure Monitor Baseline Alerts for Landing Zone policy initiative is assigned to the Landing Zones management group. This will ensure that relevant new resources created within that scope are configured with appropriate baseline alerts. For more details on what is included in the initiative please refer to https://aka.ms/amba/alz/wiki under Azure Policy Initiatives and Alert Details.",
                          "constraints": {
                              "allowedValues": [
                                  {
                                      "label": "Yes (recommended)",
                                      "value": "Yes"
                                  },
                                  {
                                      "label": "No",
                                      "value": "No"
                                  }
                              ]
                          },
                          "visible": "[equals(steps('monitor').enableMonitorBaselines,'Yes')]"
                      },
                      {
                          "name": "resourceScope",
                          "type": "Microsoft.Common.ResourceScope"
                      },
                      {
                        "name": "getLocations",
                        "type": "Microsoft.Solutions.ArmApiControl",
                        "request": {
                            "method": "GET",
                            "path": "locations?api-version=2019-11-01"
                        }
                    }
                  ]
              }
          ]
      },
      "outputs": {
          "parameters": {
            "alertName": "[monitor('alertName')]",
            "alertDescription": "[monitor('alertDescription')]",
            "targetResourceId": "[monitor('targetResourceId')]",
            "targetResourceRegion": "[monitor('targetResourceRegion')]",
            "targetResourceType": "[monitor('targetResourceType')]",
            "isEnabled": "[monitor('isEnabled')]",
            "alertSeverity": "[monitor('alertSeverity')]",
            "operator": "[monitor('operator')]",
            "threshold": "[monitor('threshold')]",
            "timeAggregation": "[monitor('timeAggregation')]",
            "windowSize": "[monitor('windowSize')]",
            "evaluationFrequency": "[monitor('evaluationFrequency')]",
            "currentDateTimeUtcNow": "[monitor('currentDateTimeUtcNow')]",
            "telemetryOptOut": "[monitor('telemetryOptOut')]"
          },
          "kind": "Tenant",
          "location": "[steps('basics').resourceScope.location.name]"
      }
  }
}
