{
  "$schema": "https://schema.management.azure.com/schemas/2021-09-09/uiFormDefinition.schema.json#",
  "view": {
    "kind": "Form",
    "properties": {
      "title": "Test Form View",
      "steps": [
        {
          "name": "basics",
          "label": "Basics",
          "elements": [
            {
              "name": "resourceScope",
              "type": "Microsoft.Common.ResourceScope",
              "location": {
                "resourceTypes": ["microsoft.resources/resourcegroups"]
              }
            },
            {
              "name": "alertName",
              "type": "Microsoft.Common.TextBox",
              "label": "Alert Name",
              "subLabel": "",
              "defaultValue": "",
              "toolTip": "Name of the alert",
              "constraints": {
                "required": true,
                "regex": "",
                "validationMessage": "",
                "validations": [
                  {
                    "isValid": "[or(or(empty(steps('basics').alertName),and(not(startsWith(steps('basics').alertName,'[[')),startsWith(steps('basics').alertName,'['),endsWith(steps('basics').alertName,']'),greater(indexOf(steps('basics').alertName,'('),-1),greater(indexOf(steps('basics').alertName,')'),-1))),greaterOrEquals(length(steps('basics').alertName),1))]",
                    "message": "The value must have a length of at least 1."
                  }
                ]
              },
              "infoMessages": [],
              "visible": true
            },
            {
              "name": "alertDescription",
              "type": "Microsoft.Common.TextBox",
              "label": "Alert Description",
              "subLabel": "",
              "defaultValue": "Vault capacity used",
              "toolTip": "Description of alert",
              "constraints": {
                "required": false,
                "regex": "",
                "validationMessage": "",
                "validations": []
              },
              "infoMessages": [],
              "visible": true
            },
            {
              "name": "targetResourceId",
              "type": "Microsoft.Common.TextBox",
              "label": "Target Resource Id",
              "subLabel": "",
              "defaultValue": "",
              "toolTip": "List of Azure resource Ids seperated by a comma. For example - /subscriptions/00000000-0000-0000-0000-0000-00000000/resourceGroup/resource-group-name/Microsoft.compute/virtualMachines/vm-name",
              "constraints": {
                "required": true,
                "regex": "",
                "validationMessage": "",
                "validations": [
                  {
                    "isValid": "[or(or(empty(steps('basics').targetResourceId),and(not(startsWith(steps('basics').targetResourceId,'[[')),startsWith(steps('basics').targetResourceId,'['),endsWith(steps('basics').targetResourceId,']'),greater(indexOf(steps('basics').targetResourceId,'('),-1),greater(indexOf(steps('basics').targetResourceId,')'),-1))),greaterOrEquals(length(steps('basics').targetResourceId),1))]",
                    "message": "The value must have a length of at least 1."
                  }
                ]
              },
              "infoMessages": [],
              "visible": true
            },
            {
              "name": "targetResourceRegion",
              "type": "Microsoft.Common.TextBox",
              "label": "Target Resource Region",
              "subLabel": "",
              "defaultValue": "",
              "toolTip": "Azure region in which target resources to be monitored are in (without spaces). For example: EastUS",
              "constraints": {
                "required": true,
                "regex": "",
                "validationMessage": "",
                "validations": []
              },
              "infoMessages": [],
              "visible": true
            },
            {
              "name": "targetResourceType",
              "type": "Microsoft.Common.TextBox",
              "label": "Target Resource Type",
              "subLabel": "",
              "defaultValue": "",
              "toolTip": "Resource type of target resources to be monitored.",
              "constraints": {
                "required": true,
                "regex": "",
                "validationMessage": "",
                "validations": [
                  {
                    "isValid": "[or(or(empty(steps('basics').targetResourceType),and(not(startsWith(steps('basics').targetResourceType,'[[')),startsWith(steps('basics').targetResourceType,'['),endsWith(steps('basics').targetResourceType,']'),greater(indexOf(steps('basics').targetResourceType,'('),-1),greater(indexOf(steps('basics').targetResourceType,')'),-1))),greaterOrEquals(length(steps('basics').targetResourceType),1))]",
                    "message": "The value must have a length of at least 1."
                  }
                ]
              },
              "infoMessages": [],
              "visible": true
            },
            {
              "name": "isEnabled",
              "type": "Microsoft.Common.DropDown",
              "label": "Is Enabled",
              "subLabel": "",
              "defaultValue": "true",
              "toolTip": "Specifies whether the alert is enabled",
              "constraints": {
                "required": false,
                "allowedValues": [
                  {
                    "label": "true",
                    "value": true
                  },
                  {
                    "label": "false",
                    "value": false
                  }
                ],
                "validations": []
              },
              "infoMessages": [],
              "visible": true
            },
            {
              "name": "alertSeverity",
              "type": "Microsoft.Common.DropDown",
              "label": "Alert Severity",
              "subLabel": "",
              "defaultValue": "1",
              "toolTip": "Severity of alert {0,1,2,3,4}",
              "constraints": {
                "required": false,
                "allowedValues": [
                  {
                    "label": "0",
                    "value": "0"
                  },
                  {
                    "label": "1",
                    "value": "1"
                  },
                  {
                    "label": "2",
                    "value": "2"
                  },
                  {
                    "label": "3",
                    "value": "3"
                  },
                  {
                    "label": "4",
                    "value": "4"
                  }
                ],
                "validations": []
              },
              "infoMessages": [],
              "visible": true
            },
            {
              "name": "operator",
              "type": "Microsoft.Common.DropDown",
              "label": "Operator",
              "subLabel": "",
              "defaultValue": "GreaterThan",
              "toolTip": "Operator comparing the current value with the threshold value.",
              "constraints": {
                "required": false,
                "allowedValues": [
                  {
                    "label": "Equals",
                    "value": "Equals"
                  },
                  {
                    "label": "GreaterThan",
                    "value": "GreaterThan"
                  },
                  {
                    "label": "GreaterThanOrEqual",
                    "value": "GreaterThanOrEqual"
                  },
                  {
                    "label": "LessThan",
                    "value": "LessThan"
                  },
                  {
                    "label": "LessThanOrEqual",
                    "value": "LessThanOrEqual"
                  }
                ],
                "validations": []
              },
              "infoMessages": [],
              "visible": true
            },
            {
              "name": "threshold",
              "type": "Microsoft.Common.TextBox",
              "label": "Threshold",
              "subLabel": "",
              "defaultValue": "75",
              "toolTip": "The threshold value at which the alert is activated.",
              "constraints": {
                "required": false,
                "regex": "",
                "validationMessage": "",
                "validations": []
              },
              "infoMessages": [],
              "visible": true
            },
            {
              "name": "timeAggregation",
              "type": "Microsoft.Common.DropDown",
              "label": "Time Aggregation",
              "subLabel": "",
              "defaultValue": "Average",
              "toolTip": "How the data that is collected should be combined over time.",
              "constraints": {
                "required": false,
                "allowedValues": [
                  {
                    "label": "Average",
                    "value": "Average"
                  },
                  {
                    "label": "Minimum",
                    "value": "Minimum"
                  },
                  {
                    "label": "Maximum",
                    "value": "Maximum"
                  },
                  {
                    "label": "Total",
                    "value": "Total"
                  },
                  {
                    "label": "Count",
                    "value": "Count"
                  }
                ],
                "validations": []
              },
              "infoMessages": [],
              "visible": true
            },
            {
              "name": "windowSize",
              "type": "Microsoft.Common.DropDown",
              "label": "Window Size",
              "subLabel": "",
              "defaultValue": "PT5M",
              "toolTip": "Period of time used to monitor alert activity based on the threshold. Must be between one minute and one day. ISO 8601 duration format.",
              "constraints": {
                "required": false,
                "allowedValues": [
                  {
                    "label": "PT1M",
                    "value": "PT1M"
                  },
                  {
                    "label": "PT5M",
                    "value": "PT5M"
                  },
                  {
                    "label": "PT15M",
                    "value": "PT15M"
                  },
                  {
                    "label": "PT30M",
                    "value": "PT30M"
                  },
                  {
                    "label": "PT1H",
                    "value": "PT1H"
                  },
                  {
                    "label": "PT6H",
                    "value": "PT6H"
                  },
                  {
                    "label": "PT12H",
                    "value": "PT12H"
                  },
                  {
                    "label": "PT24H",
                    "value": "PT24H"
                  },
                  {
                    "label": "PT1D",
                    "value": "PT1D"
                  }
                ],
                "validations": []
              },
              "infoMessages": [],
              "visible": true
            },
            {
              "name": "evaluationFrequency",
              "type": "Microsoft.Common.DropDown",
              "label": "Evaluation Frequency",
              "subLabel": "",
              "defaultValue": "PT1M",
              "toolTip": "how often the metric alert is evaluated represented in ISO 8601 duration format",
              "constraints": {
                "required": false,
                "allowedValues": [
                  {
                    "label": "PT1M",
                    "value": "PT1M"
                  },
                  {
                    "label": "PT5M",
                    "value": "PT5M"
                  },
                  {
                    "label": "PT15M",
                    "value": "PT15M"
                  },
                  {
                    "label": "PT30M",
                    "value": "PT30M"
                  },
                  {
                    "label": "PT1H",
                    "value": "PT1H"
                  }
                ],
                "validations": []
              },
              "infoMessages": [],
              "visible": true
            },
            {
              "name": "currentDateTimeUtcNow",
              "type": "Microsoft.Common.TextBox",
              "label": "Current Date Time Utc Now",
              "subLabel": "",
              "defaultValue": "[[utcNow()]",
              "toolTip": "The current date and time using the utcNow function. Used for deployment name uniqueness",
              "constraints": {
                "required": false,
                "regex": "",
                "validationMessage": "",
                "validations": []
              },
              "infoMessages": [],
              "visible": true
            },
            {
              "name": "telemetryOptOut",
              "type": "Microsoft.Common.DropDown",
              "label": "Telemetry Opt Out",
              "subLabel": "",
              "defaultValue": "No",
              "toolTip": "The customer usage identifier used for telemetry purposes. The default value of False enables telemetry. The value of True disables telemetry.",
              "constraints": {
                "required": false,
                "allowedValues": [
                  {
                    "label": "Yes",
                    "value": "Yes"
                  },
                  {
                    "label": "No",
                    "value": "No"
                  }
                ],
                "validations": []
              },
              "infoMessages": [],
              "visible": true
            }
          ]
        }
      ]
    },
    "outputs": {
      "kind": "ResourceGroup",
      "location": "[steps('basics').resourceScope.location.name]",
      "resourceGroupId": "[steps('basics').resourceScope.resourceGroup.id]",
      "parameters": {
        "alertName": "[steps('basics').alertName]",
        "alertDescription": "[steps('basics').alertDescription]",
        "targetResourceId": "[steps('basics').targetResourceId]",
        "targetResourceRegion": "[steps('basics').targetResourceRegion]",
        "targetResourceType": "[steps('basics').targetResourceType]",
        "isEnabled": "[steps('basics').isEnabled]",
        "alertSeverity": "[steps('basics').alertSeverity]",
        "operator": "[steps('basics').operator]",
        "threshold": "[steps('basics').threshold]",
        "timeAggregation": "[steps('basics').timeAggregation]",
        "windowSize": "[steps('basics').windowSize]",
        "evaluationFrequency": "[steps('basics').evaluationFrequency]",
        "currentDateTimeUtcNow": "[steps('basics').currentDateTimeUtcNow]",
        "telemetryOptOut": "[steps('basics').telemetryOptOut]"
      }
    }
  }
}
